# BuildStock Fetch

A Python CLI tool for downloading and managing building energy data from the National Renewable Energy Laboratory (NREL) BuildStock database.

## 📋 Table of Contents

- [Background & Motivation](#background--motivation)
- [Installation](#installation)
- [Quick Start](#quick-start)
- [Usage Examples](#usage-examples)
- [Command Line Interface](#command-line-interface)
- [Data Sources](#data-sources)
- [Contributing](#contributing)
- [References](#references)

## 🏗️ Background & Motivation

BuildStock Fetch provides access to the comprehensive building energy data generated by NREL's BuildStock project. This data represents detailed energy simulations of the U.S. building stock, enabling researchers, policymakers, and energy analysts to:

- **Analyze building energy consumption patterns** across different climate zones and building types
- **Evaluate energy efficiency measures** and their potential impact
- **Support energy policy development** with data-driven insights
- **Enable building energy research** with standardized, high-quality datasets

The BuildStock project simulates millions of buildings across the United States, providing granular data on energy consumption, load profiles, and building characteristics. This tool makes this valuable data accessible to the broader energy research community.

### Key Features

- 🔍 **Comprehensive Data Access**: Download HPXML files, schedules, metadata, and load curves
- 🎯 **Flexible Selection**: Choose specific states, upgrade scenarios, and building types
- 📊 **Progress Tracking**: Real-time download progress with rich terminal interface
- 🚀 **Parallel Downloads**: Efficient concurrent downloading for large datasets
- 📁 **Organized Output**: Structured file organization by release, state, and building type

## 📦 Installation

### Prerequisites

- Python 3.8 or higher
- pip or uv package manager

### Install via pip

```bash
pip install buildstock-fetch
```

### Install via uv (Recommended)

```bash
uv add buildstock-fetch
```

### Install from Source

```bash
git clone https://github.com/your-org/buildstock-fetch.git
cd buildstock-fetch
pip install -e .
```

## 🚀 Quick Start

### Interactive Mode

The easiest way to get started is using the interactive CLI:

```bash
buildstock-fetch
```

This will guide you through:
1. Selecting product type (ResStock/ComStock)
2. Choosing release year and version
3. Selecting states and upgrade scenarios
4. Picking file types to download
5. Specifying output directory

### Direct Command Line

For automated workflows, use direct command line arguments:

```bash
buildstock-fetch \
  --product resstock \
  --release_year 2022 \
  --weather_file tmy3 \
  --release_version 1 \
  --states "CA NY" \
  --file_type "metadata load_curve_15min" \
  --upgrade_id "0 1" \
  --output_directory ./data
```

## 📚 Usage Examples

### Example 1: Download Metadata for California

```bash
buildstock-fetch \
  --product resstock \
  --release_year 2022 \
  --weather_file tmy3 \
  --release_version 1 \
  --states CA \
  --file_type metadata \
  --upgrade_id 0 \
  --output_directory ./california_data
```

**Output Structure:**
```
california_data/
└── res_2022_tmy3_1/
    └── metadata/
        └── CA/
            └── metadata.parquet
```

### Example 2: Download Sample Building Files

```bash
buildstock-fetch \
  --product comstock \
  --release_year 2024 \
  --weather_file amy2018 \
  --release_version 1 \
  --states "CA TX NY" \
  --file_type "hpxml schedule" \
  --upgrade_id "0 1 2" \
  --output_directory ./sample_buildings
```

**Output Structure:**
```
sample_buildings/
└── com_2024_amy2018_1/
    ├── hpxml/
    │   ├── CA/
    │   ├── TX/
    │   └── NY/
    └── schedule/
        ├── CA/
        ├── TX/
        └── NY/
```

### Example 3: Download Load Curves for Analysis

```bash
buildstock-fetch \
  --product resstock \
  --release_year 2022 \
  --weather_file tmy3 \
  --release_version 1 \
  --states "CA MA NY" \
  --file_type "load_curve_15min metadata" \
  --upgrade_id "0 1" \
  --output_directory ./load_analysis
```

## 🖥️ Command Line Interface

### Interactive Mode

When run without arguments, BuildStock Fetch launches an interactive interface:

```
BuildStock Fetch Interactive CLI
Welcome to the BuildStock Fetch CLI!
This tool allows you to fetch data from the NREL BuildStock API.
Please select the release information and file type you would like to fetch:

Select product type: [resstock, comstock]
Select release year: [2021, 2022, 2024]
Select weather file: [tmy3, amy2018]
Select release version: [1, 2]
Select upgrade ids: [0, 1, 2, 3, 4, 5, 6, 7]
Select states: [AL, AZ, AR, CA, ...]
Select file type: [hpxml, schedule, metadata, load_curve_15min, ...]
Select output directory: ./data
```

### Command Line Options

| Option | Short | Description | Example |
|--------|-------|-------------|---------|
| `--product` | `-p` | Product type (resstock/comstock) | `--product resstock` |
| `--release_year` | `-y` | Release year | `--release_year 2022` |
| `--weather_file` | `-w` | Weather file type | `--weather_file tmy3` |
| `--release_version` | `-r` | Release version | `--release_version 1` |
| `--states` | `-s` | States (space-separated) | `--states "CA NY TX"` |
| `--file_type` | `-f` | File types (space-separated) | `--file_type "metadata hpxml"` |
| `--upgrade_id` | `-u` | Upgrade IDs (space-separated) | `--upgrade_id "0 1 2"` |
| `--output_directory` | `-o` | Output directory | `--output_directory ./data` |

### Available File Types

- **`hpxml`**: Building energy model files in HPXML format
- **`schedule`**: Occupancy and equipment schedules
- **`metadata`**: Building characteristics and metadata
- **`load_curve_15min`**: 15-minute resolution load profiles
- **`load_curve_hourly`**: Hourly resolution load profiles
- **`load_curve_daily`**: Daily resolution load profiles
- **`load_curve_monthly`**: Monthly resolution load profiles
- **`load_curve_annual`**: Annual resolution load profiles

## 📊 Data Sources

### BuildStock Project

BuildStock Fetch provides access to data from the [BuildStock project](https://www.nrel.gov/buildings/buildstock.html), which simulates the U.S. building stock using:

- **ResStock**: Residential building energy modeling
- **ComStock**: Commercial building energy modeling

### Data Releases

| Release Year | Weather Files | Available Products | Notes |
|--------------|---------------|-------------------|-------|
| 2021 | TMY3 | ResStock | Baseline scenarios only |
| 2022 | TMY3, AMY2018 | ResStock, ComStock | Full upgrade scenarios |
| 2024 | TMY3, AMY2018 | ResStock, ComStock | Latest release |
| 2025 | TMY3, AMY2018 | ResStock, ComStock | Coming soon |

### Weather Data

- **TMY3**: Typical Meteorological Year 3 data
- **AMY2018**: Actual Meteorological Year 2018 data
- **AMY2012**: Actual Meteorological Year 2012 data

## 🔧 Advanced Usage

### Batch Processing

For large-scale downloads, you can create batch scripts:

```bash
#!/bin/bash
# Download multiple releases
for year in 2021 2022 2024; do
  for state in CA NY TX; do
    buildstock-fetch \
      --product resstock \
      --release_year $year \
      --weather_file tmy3 \
      --release_version 1 \
      --states $state \
      --file_type metadata \
      --upgrade_id 0 \
      --output_directory "./data/${year}/${state}"
  done
done
```

### Python API

You can also use BuildStock Fetch programmatically:

```python
from buildstock_fetch.main import fetch_bldg_ids, fetch_bldg_data
from pathlib import Path

# Get building IDs for a specific state
bldg_ids = fetch_bldg_ids(
    product="resstock",
    release_year="2022",
    weather_file="tmy3",
    release_version="1",
    state="CA",
    upgrade_id="0"
)

# Download data
downloaded_paths, failed_downloads = fetch_bldg_data(
    bldg_ids=bldg_ids,
    file_type=("metadata", "load_curve_15min"),
    output_dir=Path("./data")
)
```

## 🤝 Contributing

We welcome contributions! Please see our [Contributing Guide](CONTRIBUTING.md) for details.

### Development Setup

```bash
git clone https://github.com/your-org/buildstock-fetch.git
cd buildstock-fetch
pip install -e ".[dev]"
```

### Running Tests

```bash
pytest tests/
```

## 📚 References

### BuildStock Project
- [BuildStock Website](https://www.nrel.gov/buildings/buildstock.html)
- [BuildStock Documentation](https://buildstock.readthedocs.io/)
- [BuildStock GitHub](https://github.com/NREL/buildstock)

### Data Sources
- [NREL OpenEI](https://openei.org/)
- [DOE Building Technologies Office](https://www.energy.gov/eere/buildings/building-technologies-office)
- [ASHRAE Standards](https://www.ashrae.org/technical-resources/standards-and-guidelines)

### Related Tools
- [HPXML](https://hpxmlonline.com/) - Home Performance XML
- [OpenStudio](https://openstudio.net/) - Building Energy Modeling
- [EnergyPlus](https://energyplus.net/) - Building Energy Simulation

### Academic Papers
- [ResStock: An Open Source Model for Simulating Single-Family Building Energy Use](https://www.nrel.gov/docs/fy19osti/73341.pdf)
- [ComStock: Using Big Data and Novel Analytics to Estimate the Energy Use and Savings Potential of the U.S. Commercial Building Stock](https://www.nrel.gov/docs/fy19osti/73342.pdf)

## 📄 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## 🙏 Acknowledgments

- **NREL BuildStock Team** for creating and maintaining the BuildStock project
- **DOE Building Technologies Office** for funding and support
- **Open Source Community** for contributions and feedback

---

*For questions, issues, or feature requests, please visit our [GitHub repository](https://github.com/your-org/buildstock-fetch) or contact us at support@buildstock-fetch.org.*
