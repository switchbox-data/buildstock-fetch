{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"buildstock-fetch","text":"<p>A CLI tool to simplify downloading building characteristics and load curve data from NREL's ResStock and ComStock projects. Also available as a Python library.</p>"},{"location":"#installing-bsf","title":"Installing bsf","text":"<p>To install the buildstock-fetch CLI tool, we recommend using uv or pipx:</p> <pre><code>uv install buildstock-fetch\n</code></pre> <p>or</p> <pre><code>pipx install buildstock-fetch\n</code></pre> <p>You'll then be able to access the <code>bsf</code> command system-wide:</p> <pre><code>bsf --help\n</code></pre>"},{"location":"#using-bsf","title":"Using bsf","text":"<p>To make it easy to download what you want from NREL's S3 bucket, <code>bsf</code> has an interactive mode. Activate it with:</p> <pre><code>bsf\n</code></pre> <p>Alternatively, you can tell <code>bsf</code> exactly what to download via CLI args:</p> <pre><code>bsf --product resstock --release_year 2022 --weather_file tmy3 --release_version 1 --states CA --file_type \"hpxml metadata\" --upgrade_id \"0 1 2\" --output_directory ./CA_data\n</code></pre> <p>For more details about the usage, see Usage</p>"},{"location":"#installing-the-python-library","title":"Installing the Python library","text":"<p>buildstock-fetch is implemented in Python, and we expose our internal functions via a library.</p> <p>If you're using Python, and you want to install the CLI only for a particular project (rather than system-wide), or you want to user the underlying library, install our PyPI package via:</p> <pre><code>pip install buildstock-fetch\n</code></pre> <p>or</p> <pre><code>uv add buildstock-fetch\n</code></pre>"},{"location":"modules/","title":"Modules","text":""},{"location":"modules/#buildstock_fetch.main.fetch_bldg_ids","title":"<code>buildstock_fetch.main.fetch_bldg_ids(product, release_year, weather_file, release_version, state, upgrade_id)</code>","text":"<p>Fetch a list of Building ID's</p> <p>Provided a state, returns a list of building ID's for that state.</p> <p>Parameters:</p> Name Type Description Default <code>product</code> <code>str</code> <p>The product type (e.g., 'resstock', 'comstock')</p> required <code>release_year</code> <code>str</code> <p>The release year (e.g., '2021', '2022')</p> required <code>weather_file</code> <code>str</code> <p>The weather file type (e.g., 'tmy3')</p> required <code>release_version</code> <code>str</code> <p>The release version number (e.g., '1')</p> required <code>state</code> <code>str</code> <p>The state to fetch building ID's for.</p> required <p>Returns:</p> Type Description <code>list[BuildingID]</code> <p>A list of building ID's for the given state.</p> Source code in <code>buildstock_fetch/main.py</code> <pre><code>def fetch_bldg_ids(\n    product: str, release_year: str, weather_file: str, release_version: str, state: str, upgrade_id: str\n) -&gt; list[BuildingID]:\n    \"\"\"Fetch a list of Building ID's\n\n    Provided a state, returns a list of building ID's for that state.\n\n    Args:\n        product: The product type (e.g., 'resstock', 'comstock')\n        release_year: The release year (e.g., '2021', '2022')\n        weather_file: The weather file type (e.g., 'tmy3')\n        release_version: The release version number (e.g., '1')\n        state: The state to fetch building ID's for.\n\n    Returns:\n        A list of building ID's for the given state.\n    \"\"\"\n\n    if product == \"resstock\":\n        product_str = \"res\"\n    elif product == \"comstock\":\n        product_str = \"com\"\n    else:\n        raise InvalidProductError(product)\n\n    release_name = f\"{product_str}_{release_year}_{weather_file}_{release_version}\"\n    if not _validate_release_name(release_name):\n        raise InvalidReleaseNameError(release_name)\n\n    # Read the specific partition that matches our criteria\n    partition_path = (\n        METADATA_DIR\n        / f\"product={product}\"\n        / f\"release_year={release_year}\"\n        / f\"weather_file={weather_file}\"\n        / f\"release_version={release_version}\"\n        / f\"state={state}\"\n    )\n\n    # Check if the partition exists\n    if not partition_path.exists():\n        return []\n\n    # Read the parquet files in the specific partition\n    df = pl.read_parquet(str(partition_path))\n\n    # No need to filter since we're already reading the specific partition\n    filtered_df = df\n\n    # Convert the filtered data to BuildingID objects\n    building_ids = []\n    for row in filtered_df.iter_rows(named=True):\n        building_id = BuildingID(\n            bldg_id=int(row[\"bldg_id\"]),\n            release_number=release_version,\n            release_year=release_year,\n            res_com=product,\n            weather=weather_file,\n            upgrade_id=upgrade_id,\n            state=state,\n        )\n        building_ids.append(building_id)\n\n    return building_ids\n</code></pre>"},{"location":"modules/#buildstock_fetch.main.fetch_bldg_data","title":"<code>buildstock_fetch.main.fetch_bldg_data(bldg_ids, file_type, output_dir, max_workers=5, weather_states=None)</code>","text":"<p>Download building data for a given list of building ids</p> <p>Downloads the data for the given building ids and returns list of paths to the downloaded files.</p> <p>Parameters:</p> Name Type Description Default <code>bldg_ids</code> <code>list[BuildingID]</code> <p>A list of BuildingID objects to download data for.</p> required <p>Returns:</p> Type Description <code>tuple[list[Path], list[str]]</code> <p>A list of paths to the downloaded files.</p> Source code in <code>buildstock_fetch/main.py</code> <pre><code>def fetch_bldg_data(\n    bldg_ids: list[BuildingID],\n    file_type: tuple[str, ...],\n    output_dir: Path,\n    max_workers: int = 5,\n    weather_states: Union[list[str], None] = None,\n) -&gt; tuple[list[Path], list[str]]:\n    \"\"\"Download building data for a given list of building ids\n\n    Downloads the data for the given building ids and returns list of paths to the downloaded files.\n\n    Args:\n        bldg_ids: A list of BuildingID objects to download data for.\n\n    Returns:\n        A list of paths to the downloaded files.\n    \"\"\"\n    file_type_obj = _parse_requested_file_type(file_type)\n    console = Console()\n\n    # Initialize weather_states to empty list if None\n    if weather_states is None:\n        weather_states = []\n\n    downloaded_paths: list[Path] = []\n    failed_downloads: list[str] = []\n\n    # Calculate total files to download\n    total_files = 0\n    if file_type_obj.metadata:\n        unique_metadata_urls = _resolve_unique_metadata_urls(bldg_ids)\n        total_files += len(unique_metadata_urls)  # Add metadata file\n    if file_type_obj.load_curve_15min:\n        total_files += len(bldg_ids)  # Add 15-minute load curve files\n    if file_type_obj.load_curve_hourly:\n        total_files += len(bldg_ids)  # Add hourly load curve files\n    if file_type_obj.load_curve_daily:\n        total_files += len(bldg_ids)  # Add daily load curve files\n    if file_type_obj.load_curve_monthly:\n        total_files += len(bldg_ids)  # Add monthly load curve files\n    if file_type_obj.load_curve_annual:\n        total_files += len(bldg_ids)  # Add annual load curve files\n    if file_type_obj.weather:\n        available_bldg_ids = [bldg_id for bldg_id in bldg_ids if bldg_id.state in weather_states]\n        total_files += len(available_bldg_ids) * len(weather_states)  # Add weather map files\n\n    console.print(f\"\\n[bold blue]Starting download of {total_files} files...[/bold blue]\")\n\n    with Progress(\n        SpinnerColumn(),\n        TextColumn(\"[progress.description]{task.description}\"),\n        BarColumn(),\n        TaskProgressColumn(),\n        TextColumn(\"\u2022\"),\n        DownloadColumn(),\n        TextColumn(\"\u2022\"),\n        TransferSpeedColumn(),\n        TextColumn(\"\u2022\"),\n        TimeRemainingColumn(),\n        console=console,\n        transient=False,\n    ) as progress:\n        _execute_downloads(\n            file_type_obj,\n            bldg_ids,\n            output_dir,\n            max_workers,\n            progress,\n            downloaded_paths,\n            failed_downloads,\n            console,\n            weather_states,\n        )\n\n        # TODO: add EV related files\n        # TODO: Write a function for downloading EV related files from SB's s3 bucket.\n        # It should dynamically build the download url based on the release_name + state combo.\n        # Make sure to follow the directory structure for downloading the files.\n        if file_type_obj.trip_schedules:\n            _download_trip_schedules_data(bldg_ids, output_dir, downloaded_paths)\n\n    _print_download_summary(downloaded_paths, failed_downloads, console)\n\n    return downloaded_paths, failed_downloads\n</code></pre>"},{"location":"usage/","title":"BuildStock Fetch","text":"<p>A Python CLI tool for downloading building energy simulation data from the National Renewable Energy Laboratory (NREL) ResStock and ComStock projects.</p>"},{"location":"usage/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Background</li> <li>Installation</li> <li>Quick Start</li> <li>Usage Examples</li> <li>Command Line Interface</li> <li>Data Sources</li> <li>Contributing</li> <li>References</li> </ul>"},{"location":"usage/#background","title":"Background","text":"<p>NREL's ResStock and ComStock projects, collectively known as BuildStock, offer a statistically representative snapshot of buildings across the United States. These realistic-but-not-real buildings are then loaded into building energy modeling (BEM) software EnergyPlus, in order to estimate their weather-dependent energy consumption and water use by simulating heating, cooling, lighting, ventilation, and other energy flows.</p> <p>The simulations output end-use load profiles, which NREL releases as open data. But it's also possible to do your own Buildstock simulations using the same building and weather file that NREL uses.</p> <p>BuildStock Fetch is a python library that makes it easy to download NREL's end-use load profiles, as well as the hpxml, weather, and other input files needed to run your simulations using OCHRE a lightweight BEM library also developed by NREL.</p>"},{"location":"usage/#key-features","title":"Key Features","text":"<ul> <li>Comprehensive Data Access: Download physical building characteristics, load and occupancy schedules, simulated load curves, and weather files.</li> <li>Flexible Selection: Choose specific states, upgrade scenarios, and building types.</li> <li>Organized Output: Structured file organization by release version, state, and building type.</li> </ul>"},{"location":"usage/#data-source","title":"Data source","text":"<p>BuildStock Fetch (<code>bsf</code>) makes it easier to download the files available on NREL's public aws s3 buckets.</p> <p>Besides weather files, all the data that <code>bsf</code> allows you to download is on building units, either residential dwellings or commercial establishments.</p>"},{"location":"usage/#buildstock-releases","title":"Buildstock Releases","text":"<p>These units are grouped into Buildstock releases, which are defined by:</p> <ul> <li> <p>Product: either ResStock (for residential buildings) or ComStock (for commercial buildings).</p> </li> <li> <p>Release Year: The year of release. NREL's first release was in 2021, and each subsequent year has seen its own set of new releases.</p> </li> <li> <p>Weather File: Building energy simulations require weather files, which represent temperature, moisture, solar radiation, and other environmental condition. NREL has usef three different weather files for ComStock and ResStock: <code>tmy3</code>, <code>amy2012</code>, and <code>amy2018</code>.</p> </li> <li><code>tmy3</code> stands for Typical Meteorological Year 3. This is a synthetic weather dataset that represent a \"typical\" annual weather conditions and were built using historical weather data from 1991-2005.</li> <li><code>amy2012</code> stands for Actual Meteorological Year 2012, and represents actual weather data from 2012.</li> <li> <p><code>amy2018</code> stands for Actual Meteorological Year 2018, and represents actual weather data from 2018.</p> </li> <li> <p>Release Version: Most releases have only one version, which is version 1. NREL will occasionally correct or update a release, these releases will have versions 1.1 or 2.</p> </li> <li> <p>Upgrades: that main value of ResStock and ComStock is the ability to run \"what if?\" scenarios, where building shells and equipment are altered in order to compare the resulting simulated load curve to the current baseline building stock. Each release has its own distinct list of numbered upgrade scenarios, representing various building envelope and equipment upgrades, including weatherization packages, efficient electrical appliances, and so on.</p> </li> </ul>"},{"location":"usage/#available-datasets","title":"Available datasets","text":"<p><code>bsf</code> makes it easier to download three kinds of files:</p> <ul> <li> <p>Building Unit Metadata: The metadata table offers information each building unit for each upgrade within each release. This information includes the building unit's <code>bldg_id</code>, overall physical characteristics (square footage, number of rooms, etc.), the building envelope, all energy consuming devices, air infilation levels, approximate physical location, income range, and so on. These building units are synthetic, drawn from a stastistical distribution of the US building stock assembled from dozens of surveys and other datasets.</p> </li> <li> <p>End Use Load Profiles: NREL maps these synthetic buildings to geometric models in EnergyPlus, and runs physics simulations with particular weather files in order to generate energy consumption load curves for every appliances in every building unit in a given release. NREL then publishes these simulation outputs under the End Use Load Profiles data product. These datasets provide detailed simulation input parameters and load outputs, such as fuel consumption by usage type (e.g. space heating/cooling, water heating, lights, etc.), and building conditions (e.g. indoor temperature and humidity, hot water temperature, etc.). NREL publishes these profiles at 15-min time granularity for each building unit in a particular release, as well as yearly aggregates. Load are often needed at the hourly or monthly level for anaysis, so <code>bsf</code> plans to offer these pre-aggregated datasets in the future to save you time.</p> </li> <li> <p>Building Simulation Input Data: NREL also makes available the input files they use to run these simulations, which are the building metadata in HPXML format, equipment and occupancy schedule files, and weather files. You can use these input files to run your own simulations of Buildstock building units, either in EnergyPlus (via buildstock-batch) or in OCHRE, a new building energy simulation tool developed by NREL. OCHRE is meant to be lighter-weight alternative to other numerical simulation softwares such as EnergyPlus or TRNSYS. OCHRE requires as input a building HPXML file that provides information on the building envelope and HVAC and water heating equipment, the schedule files that provide load profiles for non-controllable appliance use such as lights or dishwasher and occupancy levels, and weather files. Each building HPXML file has a corresponding weather station ID based on its location, and <code>bsf</code> can fetch this for you too.</p> </li> </ul>"},{"location":"usage/#installation","title":"Installation","text":""},{"location":"usage/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.9 or higher</li> <li><code>pip</code> or <code>uv</code> package manager</li> </ul>"},{"location":"usage/#install-from-source","title":"Install from Source","text":"<p>BuildStock Fetch is not yet available as a published library on PyPI. In the meantime, the library can be installed directly from the GitHub repository using:</p> <pre><code>pip3 install git+https://github.com/switchbox-data/buildstock-fetch.git@main\n</code></pre>"},{"location":"usage/#quick-start","title":"Quick Start","text":"<p>To download data with BuildStock Fetch, you must specify the following variables: product type, release year, weather file type, release version, upgrade scenarios, state, types of files to download, and output directory. Once these inputs have been specified, BuildStock Fetch will first resolved the individual <code>bldg_ids</code> correspond to this  selection, and then download the requested files pertaining to each building unit to the specified output directory.</p>"},{"location":"usage/#interactive-mode","title":"Interactive Mode","text":"<p>The easiest way to get started is using the interactive CLI:</p> <pre><code>bsf\n</code></pre> <p>This will guide you through:</p> <ol> <li>Selecting product type (ResStock/ComStock)</li> <li>Choosing release year</li> <li>Choosing the weather file type</li> <li>Choosing the release version</li> <li>Selecting the upgrade scenarios (you can choose multiple)</li> <li>Selecting the state (you can choose multiple)</li> <li>Selecting the file types to download (you can choose multiple)</li> <li>Specifying the output directory for the downloaded files.</li> </ol> <p>The interactive CLI mode only shows valid release options and file types, based on what's currently available on NREL's s3 bucket.</p>"},{"location":"usage/#downloading-a-sample","title":"Downloading a sample","text":"<p>Once all the inputs have been collected, BuildStock Fetch will ask whether to download all files for the release, or just a sample. Each release has around 10,000 to 30,000 building units associated with it. If the user wishes to download just a small sample, they can specify the number of files to download for each state-upgrade version pair.</p>"},{"location":"usage/#direct-command-line","title":"Direct Command Line","text":"<p>You can also use specify the buildstock release, file types, and geography in one go, using direct command line arguments:</p> <pre><code>bsf \\\n  --product resstock \\\n  --release_year 2022 \\\n  --weather_file tmy3 \\\n  --release_version 1 \\\n  --states \"CA NY\" \\\n  --file_type \"metadata load_curve_15min\" \\\n  --upgrade_id \"0 1\" \\\n  --output_directory ./data\n</code></pre> <p><code>bsf</code> will warn you if you've specified an invalid buildstock release, state, file type, upgrade, or output directory.</p>"},{"location":"usage/#output-structure","title":"Output Structure","text":"<p>The <code>--output_directory</code> option specifies the top directory where the files will be downloaded. From there, the files will be organized as:</p> <pre><code>output_directory/\n\u2514\u2500\u2500 release_name/\n    \u2514\u2500\u2500 file_type/\n        \u2514\u2500\u2500 state/\n            \u2514\u2500\u2500 bldgid1_file\n            \u2514\u2500\u2500 bldgid2_file\n            \u2514\u2500\u2500 ...\n</code></pre>"},{"location":"usage/#usage-examples","title":"Usage Examples","text":""},{"location":"usage/#example-1-download-metadata-for-california","title":"Example 1: Download Metadata for California","text":"<pre><code>bsf \\\n  --product resstock \\\n  --release_year 2022 \\\n  --weather_file tmy3 \\\n  --release_version 1 \\\n  --states CA \\\n  --file_type metadata \\\n  --upgrade_id 0 \\\n  --output_directory ./california_data\n</code></pre>"},{"location":"usage/#example-2-download-sample-building-files","title":"Example 2: Download Sample Building Files","text":"<pre><code>bsf \\\n  --product comstock \\\n  --release_year 2024 \\\n  --weather_file amy2018 \\\n  --release_version 1 \\\n  --states \"CA TX NY\" \\\n  --file_type \"hpxml schedule\" \\\n  --upgrade_id \"0 1 2\" \\\n  --output_directory ./sample_buildings\n</code></pre> <p>Output Structure:</p> <pre><code>sample_buildings/\n\u2514\u2500\u2500 com_2024_amy2018_1/\n    \u251c\u2500\u2500 hpxml/\n    \u2502   \u251c\u2500\u2500 CA/\n    \u2502   \u2502   \u251c\u2500\u2500 bldg_id1_up_0.xml\n    \u2502   \u2502   \u251c\u2500\u2500 bldg_id1_up_1.xml\n    \u2502   \u2502   \u251c\u2500\u2500 bldg_id1_up_2.xml\n    \u2502   \u2502   \u251c\u2500\u2500 bldg_id2_up_0.xml\n    \u2502   \u2502   \u251c\u2500\u2500 ...\n    \u2502   \u251c\u2500\u2500 TX/\n    \u2502   \u2502   \u251c\u2500\u2500 bldg_id1_up_0.xml\n    \u2502   \u2502   \u251c\u2500\u2500 bldg_id1_up_1.xml\n    \u2502   \u2502   \u251c\u2500\u2500 ...\n    \u2502   \u2514\u2500\u2500 NY/\n    \u2502   \u2502   \u251c\u2500\u2500 bldg_id1_up_0.xml\n    \u2502   \u2502   \u251c\u2500\u2500 bldg_id1_up_1.xml\n    \u2502   \u2502   \u251c\u2500\u2500 ...\n    \u2514\u2500\u2500 schedule/\n        \u251c\u2500\u2500 CA/\n        \u2502   \u251c\u2500\u2500 bldg_id1_up_0_schedule.csv\n        \u2502   \u251c\u2500\u2500 bldg_id1_up_1_schedule.csv\n        \u2502   \u251c\u2500\u2500 bldg_id1_up_2_schedule.csv\n        \u2502   \u251c\u2500\u2500 bldg_id2_up_0_schedule.csv\n        \u2502   \u251c\u2500\u2500 ...\n        \u251c\u2500\u2500 ...\n</code></pre>"},{"location":"usage/#example-3-download-load-curves-for-analysis","title":"Example 3: Download Load Curves for Analysis","text":"<pre><code>bsf \\\n  --product resstock \\\n  --release_year 2022 \\\n  --weather_file tmy3 \\\n  --release_version 1 \\\n  --states \"CA MA NY\" \\\n  --file_type \"load_curve_15min\" \\\n  --upgrade_id \"0 1\" \\\n  --output_directory ./load_analysis\n</code></pre>"},{"location":"usage/#command-line-interface","title":"Command Line Interface","text":""},{"location":"usage/#interactive-mode_1","title":"Interactive Mode","text":"<p>When run without arguments, BuildStock Fetch launches an interactive interface:</p> <pre><code>BuildStock Fetch Interactive CLI\nWelcome to the BuildStock Fetch CLI!\nThis tool allows you to fetch data from the NREL BuildStock API.\nPlease select the release information and file type you would like to fetch:\n\nSelect product type: [resstock, comstock]\nSelect release year: [2021, 2022, 2023, 2024, ...]\nSelect weather file: [tmy3, amy2012, amy2018]\nSelect release version: [1, 1.1, 2]\nSelect upgrade ids: [0, 1, 2, 3, 4, 5, 6, 7, ...]\nSelect states: [AL, AZ, AR, CA, ...]\nSelect file type: [hpxml, schedule, metadata, load_curve_15min, ...]\nSelect output directory: ./data\n</code></pre>"},{"location":"usage/#command-line-options","title":"Command Line Options","text":"Option Short Description Example <code>--product</code> <code>-p</code> Product type (resstock/comstock) <code>--product resstock</code> <code>--release_year</code> <code>-y</code> Release year <code>--release_year 2022</code> <code>--weather_file</code> <code>-w</code> Weather file type <code>--weather_file tmy3</code> <code>--release_version</code> <code>-r</code> Release version <code>--release_version 1</code> <code>--states</code> <code>-s</code> States (space-separated) <code>--states \"CA NY TX\"</code> <code>--file_type</code> <code>-f</code> File types (space-separated) <code>--file_type \"metadata hpxml\"</code> <code>--upgrade_id</code> <code>-u</code> Upgrade IDs (space-separated) <code>--upgrade_id \"0 1 2\"</code> <code>--output_directory</code> <code>-o</code> Output directory <code>--output_directory ./data</code> <p>You can also run</p> <pre><code>bsf --help\n</code></pre> <p>to see these options</p>"},{"location":"usage/#available-file-types","title":"Available File Types","text":"<ul> <li><code>hpxml</code>: Building energy model files in HPXML format</li> <li><code>schedule</code>: Occupancy and equipment schedules</li> <li><code>metadata</code>: Building characteristics and metadata</li> <li><code>load_curve_15min</code>: 15-minute resolution load profiles</li> <li><code>load_curve_hourly</code>: Hourly resolution load profiles</li> <li><code>load_curve_daily</code>: Daily resolution load profiles</li> <li><code>load_curve_monthly</code>: Monthly resolution load profiles</li> <li><code>load_curve_annual</code>: Annual resolution load profiles</li> </ul>"},{"location":"usage/#python-api","title":"Python API","text":"<p>You can also use BuildStock Fetch programmatically:</p> <pre><code>from buildstock_fetch.main import fetch_bldg_ids, fetch_bldg_data\nfrom pathlib import Path\n\n# Get building IDs for a specific state\nbldg_ids = fetch_bldg_ids(\n    product=\"resstock\",\n    release_year=\"2022\",\n    weather_file=\"tmy3\",\n    release_version=\"1\",\n    state=\"CA\",\n    upgrade_id=\"0\"\n)\n\n# Download data\ndownloaded_paths, failed_downloads = fetch_bldg_data(\n    bldg_ids=bldg_ids,\n    file_type=(\"metadata\", \"load_curve_15min\"),\n    output_dir=Path(\"./data\")\n)\n</code></pre>"}]}